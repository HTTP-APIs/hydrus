# Hydra Workflow

This document can be used to understand how hydra works. <br>
To understand the concepts related to hydrus:<br>
https://www.hydraecosystem.org/Starting-Material

### How is an ```ApiDoc``` defined:
- There are two ways of defining an ApiDoc:
  1. Writing a Hydra-compliant JSON-LD like [here]( https://github.com/HTTP-APIs/hydrus/blob/master/hydrus/samples/doc_writer_sample_output.py).
  2. Defining the ApiDoc programmatically using the code like in [here](https://github.com/HTTP-APIs/hydrus/blob/master/hydrus/samples/doc_writer_sample.py).
- Any valid ApiDoc can be passed to the server so that it can parse the doc, generate a database and start the server.
- The document containing the context is generated by the doc_maker file in the hydra_python_core repo. hydrus provides the link in its response for the context.    


### Points :
#### Description of some files:
1. [*hydrus/app.py*](https://github.com/HTTP-APIs/hydrus/blob/develop/hydrus/app.py).
   1. Used for logging. [Line 22](https://github.com/HTTP-APIs/hydrus/blob/c6a8587c7904afe64c31f74da1f9d4edc7139ed2/hydrus/app.py#L22).
   2. Starts the SQLAlchemy engine and creates a session [Line 30](https://github.com/HTTP-APIs/hydrus/blob/c6a8587c7904afe64c31f74da1f9d4edc7139ed2/hydrus/app.py#L30).
   3. Creates an Api Documentation using the [doc_maker() of hydra_python_core](https://hydra-python-core.readthedocs.io/_/downloads/en/develop/pdf/).
   4. Gets the parsed classes from [hydrus/data/doc_parse.py](https://github.com/HTTP-APIs/hydrus/blob/develop/hydrus/data/doc_parse.py).
   5. Creates database tables and its metadata [Line 34-36](https://github.com/HTTP-APIs/hydrus/blob/c6a8587c7904afe64c31f74da1f9d4edc7139ed2/hydrus/data/doc_parse.py#L34).
   6. Checks if Authentication is True, adds user to the session.[Check](https://www.hydraecosystem.org/Auth).
   7. Calls app_factory class' constructor.
   8. Sets authentication,api_name,session etc. which can be later retrieved using the corresponding get functions.
   9. Runs the API on the Port mentioned.
1. [*hydrus/app_factory.py*](https://github.com/HTTP-APIs/hydrus/blob/develop/hydrus/app_factory.py)
   1. Used to add resources to the API from `resources.py`.
   1. Configures properties of API.
   1. Enables CORS.
1. [*hydrus/resources.py*](https://github.com/HTTP-APIs/hydrus/blob/develop/hydrus/resources.py)
   1. Contains classes which are added as resources to the API.

1. [*hydrus/samples/hydra_doc_sample.py*](https://github.com/HTTP-APIs/hydrus/blob/develop/hydrus/samples/hydra_doc_sample.py).
   1. This file contains the sample ApiDoc that is displayed when the demo for hydrus is run. It contains the [JSON-LD](https://json-ld.org/) document that is displayed.
